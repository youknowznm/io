---
layout: default
title: JS随笔
---

`getAttr()`返回字符串或`null`；直接读取元素属性返回`undefined`或对象（目标为`style`时）或函数（目标为`event`时）。

直接读取不存在的local storage属性会报错，用`getItem()`会返回`null`。

\w === [0-9a-zA-Z_]

绝大多数情况应使用全等。

多数类数组对象有`length`属性、可使用方括号访问项、可遍历，但对`Array.isArray()`返回假，也没有`map()`等迭代方法，不然为啥叫它类数组对象。

`call()`接受参数列表，`apply()`接受参数数组。

非自定义的特性才能成为元素的属性。

`innerHTML`是调用标签内包含的所有内容，`cloneNode()`返回节点本身，不包含其`innterHTML`。

`onkeydown`和`onkeypress`在文本框发生变化前触发，`onkeyup`则在变化之后。

传入`splice()`方法的字符串本身会发生改变，该方法返回的是移除的项！

拖拽系列事件：

* `dragstart` 开始拖拽时，一次
* `drag` 拖拽时，不停触发
* `dragenter` 目标进入有效放置区域，一次
* `dragexit` 目标不再是拖拽的即时对象时，一次
* `dragleave` 目标离开有效放置区域，一次
* `dragover` 目标经过有效放置目标时，不停触发
* `drop` 元素放置在有效放置区域，一次
* `dragend` 拖拽结束（放开左键或esc），一次

`RegExp.test(str)`返回布尔值，`str.match(RegExp)`返回数组。

`Array`的几个迭代方法向接收的函数自动传入调用者的`item`, `index`, `array`三个参数。

如果需要向事件响应函数中传入参数则必须将其放在匿名函数内部，否则其会立即执行。

JS的函数在JSON字符串中同样也以字符串形式体现。保存函数`value.toString()`，读取函数`eval( ‘(‘ + value + ‘)’ )`。

`XMLHttpRequest.onload`事件在请求完成时触发，此时实例的`readystate`为4。

***

按时间间隔调整元素位置时，元素会在调整结束后闪烁，推测为变化量非整数所导致。对单位时间调整的距离使用`floor()`或`ceil()`后问题解决。

浮点数运算的结果有时带有长长的一段小数，产生恶劣影响。原因大致是JS浮点数的计算是以2进制计算的，我的解决方法是遇到如改变元素透明度等情况时先将其扩大100倍后再处理，最后将缩小的值写入样式。

以task0003为例，缕一下到底什么时候要保存或读取，当时很费劲。

* 保存：
    添加cate
    删除cate
    标记task为done
    新建task
    编辑task
* 读取：
    刷新页面一直读取运行时的task和cate，跟localStorage里的毛关系都没有…所以只有读取页面时需要load一次。




