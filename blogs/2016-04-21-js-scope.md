---
layout: default
title: JS - 作用域
---

预编译时声明所有变量和函数，为表达式创建的变量和函数赋`undefined`值，为`this`和定义式创建的函数赋给定值。此为第一次运行上下文的创建：
    
* 函数的每次调用都会产生新的运行上下文（包含由实参、形参、内部函数和变量、`this`共同组成的活动对象，此对象被推入作用域链的前端）。每个运行上下文在该函数调用结束且未产生闭包时被销毁。

作用域是函数被创建的作用域中对象的集合，决定了其可以访问哪些数据。函数运行在其被定义的作用域里，而不是被执行的作用域里。

标识符的值从作用域链的前端向末端查找，位于作用域链越深处的标识符，其读写速度就会越慢。故将被引用一次以上的跨作用域对象保存在局部变量中后再使用可提升性能。

不使用`var`关键字可定义全局变量的过程，实际上就是对从作用域链前端至末端（`window`全局对象）都未找到的、故其值为`undefined`的变量赋值的过程。

`with`和`catch`语句会改变运行时的作用域链：前者将新的目标作用域推入了作用域链前端，原局部变量处于第二个作用域对象中，损失性能，不建议使用；后者将异常对象推入作用域链前端，原局部变量处于第二个作用域对象中，在`catch`语句结束后恢复原状态。

JS预编译时以每个`<script>`标签作为编译单元，此标签内以任何方式定义的属性和函数均无法在此标签之前的单元内直接使用。故功能性的脚本标签必须置于其它脚本之前。